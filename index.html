<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modbus RTU/RS-485 Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Top Navigation Bar -->
    <nav class="top-navbar">
        <div class="navbar-left">
            <button class="sidebar-toggle" id="sidebarToggle">
                <span class="toggle-icon">‚ò∞</span>
            </button>
            <div class="navbar-logo">
                <img src="main_logo.jpg" alt="Logo" class="navbar-logo-img">
            </div>
            <div class="navbar-title">EC-FAN Controller</div>
        </div>
        <div class="navbar-right">
            <div class="navbar-stats" id="navbarStats">
                <div class="navbar-stat-item" title="Total Requests">
                    <span class="navbar-stat-label">REQ</span>
                    <span class="navbar-stat-value" id="navStatRequests">0</span>
                </div>
                <div class="navbar-stat-item" title="Successful Responses">
                    <span class="navbar-stat-label">OK</span>
                    <span class="navbar-stat-value" id="navStatSuccess">0</span>
                </div>
                <div class="navbar-stat-item" title="Error Count">
                    <span class="navbar-stat-label">ERR</span>
                    <span class="navbar-stat-value" id="navStatErrors">0</span>
                </div>
                <div class="navbar-stat-item" title="Success Rate">
                    <span class="navbar-stat-label">RATE</span>
                    <span class="navbar-stat-value" id="navStatRate">0%</span>
                </div>
                <div class="navbar-stat-item" title="Errors per N frames">
                    <span class="navbar-stat-label">ERR/N</span>
                    <span class="navbar-stat-value" id="navStatErrorRate">0</span>
                </div>

                <!-- Detailed Stats Tooltip -->
                <div class="navbar-stats-tooltip" id="navbarStatsTooltip">
                    <div class="stats-tooltip-header">Communication Statistics</div>
                    <div class="stats-tooltip-row">
                        <span class="stats-tooltip-label">Total Requests:</span>
                        <span class="stats-tooltip-value" id="tooltipRequests">0</span>
                    </div>
                    <div class="stats-tooltip-row">
                        <span class="stats-tooltip-label">Successful:</span>
                        <span class="stats-tooltip-value" id="tooltipSuccess">0</span>
                    </div>
                    <div class="stats-tooltip-row">
                        <span class="stats-tooltip-label">Errors:</span>
                        <span class="stats-tooltip-value" id="tooltipErrors">0</span>
                    </div>
                    <div class="stats-tooltip-row">
                        <span class="stats-tooltip-label">Success Rate:</span>
                        <span class="stats-tooltip-value" id="tooltipRate">0%</span>
                    </div>
                    <div class="stats-tooltip-divider"></div>
                    <div class="stats-tooltip-row">
                        <span class="stats-tooltip-label">Error Rate:</span>
                        <span class="stats-tooltip-value">
                            <span id="tooltipErrorRate">0</span> errors per <span id="tooltipBaseFrames">1000</span> frames
                        </span>
                    </div>
                    <div class="stats-tooltip-divider"></div>
                    <div class="stats-tooltip-header" style="font-size: 12px; margin-top: 5px;">Per Device Stats</div>
                    <div id="deviceStatsContainer" class="device-stats-container">
                        <p style="color: #6c757d; font-size: 11px;">No device data yet</p>
                    </div>
                </div>
            </div>
            <div class="navbar-connection">
                <span id="navbar-status-indicator" class="navbar-status-indicator status-disconnected"></span>
                <span id="navbar-status-text" class="navbar-status-text">Disconnected</span>
            </div>
            <button class="monitor-toggle-btn" id="monitorToggleBtn" title="Communication Monitor">
                <span class="monitor-toggle-icon">üì°</span>
                <span class="monitor-toggle-text">Monitor</span>
            </button>
        </div>
    </nav>

    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-menu">
                <!-- Serial Port Menu Item -->
                <div class="menu-item-expandable" id="serialPortMenu">
                    <div class="menu-item-header">
                        <span class="menu-item-icon">üîå</span>
                        <span class="menu-item-text">Serial Port</span>
                        <span class="menu-item-arrow">‚ñº</span>
                    </div>
                    <div class="menu-item-content">
                        <div class="sidebar-form-group">
                            <label for="sidebar-baudRate">Baud Rate</label>
                            <select id="sidebar-baudRate">
                                <option value="9600">9600</option>
                                <option value="19200">19200</option>
                                <option value="38400">38400</option>
                                <option value="57600">57600</option>
                                <option value="115200">115200</option>
                            </select>
                        </div>
                        <div class="sidebar-form-row">
                            <div class="sidebar-form-group">
                                <label for="sidebar-parity">Parity</label>
                                <select id="sidebar-parity">
                                    <option value="none" selected>None</option>
                                    <option value="even">Even</option>
                                    <option value="odd">Odd</option>
                                </select>
                            </div>
                            <div class="sidebar-form-group">
                                <label for="sidebar-dataBits">Data</label>
                                <select id="sidebar-dataBits">
                                    <option value="7">7</option>
                                    <option value="8" selected>8</option>
                                </select>
                            </div>
                            <div class="sidebar-form-group">
                                <label for="sidebar-stopBits">Stop</label>
                                <select id="sidebar-stopBits">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                </select>
                            </div>
                        </div>
                        <div class="sidebar-button-group">
                            <button id="sidebar-connectBtn" class="btn btn-primary btn-block">Connect</button>
                            <button id="sidebar-disconnectBtn" class="btn btn-secondary btn-block" disabled>Disconnect</button>
                        </div>
                    </div>
                </div>
                <div class="menu-item active" data-page="dashboard">
                    <span class="menu-item-icon">üì±</span>
                    <span class="menu-item-text">Dashboard</span>
                </div>
                <div class="menu-item" data-page="device-setup">
                    <span class="menu-item-icon">‚öôÔ∏è</span>
                    <span class="menu-item-text">Device</span>
                </div>
                <div class="menu-item" data-page="modbus">
                    <span class="menu-item-icon">üì°</span>
                    <span class="menu-item-text">Modbus</span>
                </div>
                <div class="menu-item" data-page="firmware">
                    <span class="menu-item-icon">üì•</span>
                    <span class="menu-item-text">Update</span>
                </div>
                <div class="menu-item" data-page="chart">
                    <span class="menu-item-icon">üìà</span>
                    <span class="menu-item-text">Chart</span>
                </div>
            </nav>

            <!-- Settings Button at Bottom -->
            <div class="sidebar-footer">
                <button class="sidebar-settings-btn" id="openSettingsBtn">
                    <span class="settings-icon">‚öôÔ∏è</span>
                    <span class="settings-text">Settings</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">

                <!-- Dashboard Page (Product Test) -->
                <div id="page-dashboard" class="page-content">
                    <!-- Dashboard Header -->
                    <div class="dashboard-header">
                        <div class="dashboard-title-section">
                            <h1>Product Test Dashboard</h1>
                            <p class="dashboard-subtitle">Ïó∞Í≤∞Îêú Ï†úÌíàÎì§ÏùÑ Í∞úÎ≥Ñ ÎòêÎäî ÏùºÍ¥Ñ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§</p>
                        </div>
                        <div class="dashboard-actions">
                            <button id="addDeviceBtn" class="btn btn-primary">
                                <span>+</span> Add Device
                            </button>
                            <button id="autoAssignIdBtn" class="btn btn-info">
                                <span>‚ö°</span> Auto Assign IDs
                            </button>
                            <button id="refreshAllBtn" class="btn btn-secondary">
                                <span>‚Üª</span> Refresh All
                            </button>
                        </div>
                    </div>

                    <!-- All Device Control Section (same style as Device List) -->
                    <section class="device-list-section all-device-control-section">
                        <div class="section-header">
                            <div class="section-header-left">
                                <h3>All Device Control</h3>
                                <span class="device-count-badge selection-badge" id="selectedDeviceCount">0Í∞ú ÏÑ†ÌÉù</span>
                                <div class="selected-devices-chips" id="selectedDevicesChips"></div>
                            </div>
                            <div class="section-header-right">
                                <button id="selectAllDevices" class="btn btn-sm btn-outline">Ï†ÑÏ≤¥ ÏÑ†ÌÉù</button>
                                <button id="deselectAllDevices" class="btn btn-sm btn-outline">ÏÑ†ÌÉù Ìï¥Ï†ú</button>
                            </div>
                        </div>
                        <div class="all-device-control-content">
                            <div class="all-device-control-row">
                                <div class="all-device-control-item">
                                    <label>Setpoint</label>
                                    <div class="all-device-setpoint-wrapper">
                                        <input type="number" id="allDeviceSetpoint" min="0" max="10000" value="0" class="all-device-setpoint-input">
                                        <span class="all-device-setpoint-unit" id="allDeviceSetpointUnit">RPM</span>
                                        <input type="range" id="allDeviceSetpointSlider" min="0" max="10000" value="0" class="all-device-setpoint-slider">
                                    </div>
                                </div>
                                <div class="all-device-control-item">
                                    <label>Î™®Îìú</label>
                                    <div class="all-device-mode-toggle">
                                        <button class="mode-btn active" data-mode="0" id="allDeviceModeRpm">RPM</button>
                                        <button class="mode-btn" data-mode="1" id="allDeviceModePct">%</button>
                                    </div>
                                </div>
                                <div class="all-device-control-item all-device-control-actions">
                                    <label>&nbsp;</label>
                                    <div class="all-device-action-btns">
                                        <button id="allDeviceApplyBtn" class="btn btn-success" disabled>
                                            <span>‚ñ∂</span> Ï†ÅÏö©
                                        </button>
                                        <button id="allDeviceStopBtn" class="btn btn-danger" disabled>
                                            <span>‚ñ†</span> Ï†ïÏßÄ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Device List Section -->
                    <section class="device-list-section">
                        <div class="section-header">
                            <div class="section-header-left">
                                <h3>Device List</h3>
                                <span class="device-count-badge" id="totalDeviceCount">0Í∞ú</span>
                            </div>
                            <div class="section-header-right">
                                <div class="view-mode-toggle">
                                    <button class="view-mode-btn" data-view="card" id="viewModeCard" title="Ïπ¥ÎìúÌòï Î≥¥Í∏∞">
                                        <span>‚ñ¶</span>
                                    </button>
                                    <button class="view-mode-btn active" data-view="list" id="viewModeList" title="Î™©Î°ùÌòï Î≥¥Í∏∞">
                                        <span>‚ò∞</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="device-grid" id="deviceGrid">
                            <!-- Device cards will be dynamically added here -->
                            <div class="device-placeholder" id="devicePlaceholder">
                                <div class="placeholder-icon">üì¶</div>
                                <p>Îì±Î°ùÎêú Ï∂ïÏù¥ ÏóÜÏäµÎãàÎã§</p>
                                <p class="placeholder-hint">"Add Device" Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÌÖåÏä§Ìä∏Ìï† Ï†úÌíàÏùÑ Îì±Î°ùÌïòÏÑ∏Ïöî</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Device Setup Page -->
                <div id="page-device-setup" class="page-content">
                    <div style="height: 100%; display: flex; align-items: flex-start; justify-content: center; padding: 40px 20px;">
                        <div style="display: flex; width: 100%; max-width: 1400px; height: calc(100vh - 180px); overflow: hidden; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">
                        <!-- Left: Device List -->
                        <div style="width: 240px; background: #fafafa; border-right: 1px solid #e5e5e5; padding: 20px 12px; display: flex; flex-direction: column; overflow: hidden; flex-shrink: 0;">
                            <h3 style="margin-bottom: 15px; color: #404040; font-size: 12px; font-weight: 600; letter-spacing: 0.8px; text-transform: uppercase; flex-shrink: 0;">Devices</h3>
                            <div id="deviceSetupList" style="flex: 1; overflow-y: auto; display: flex; flex-direction: column;">
                                <div style="text-align: center; padding: 60px 15px; color: #6c757d;">
                                    <div style="font-size: 42px; margin-bottom: 10px;">üì¶</div>
                                    <p style="font-size: 13px; line-height: 1.5;">Îì±Î°ùÎêú ÎîîÎ∞îÏù¥Ïä§Í∞Ä ÏóÜÏäµÎãàÎã§</p>
                                    <p style="font-size: 11px; margin-top: 8px; color: #999;">DashboardÏóêÏÑú ÎîîÎ∞îÏù¥Ïä§Î•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî</p>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Tab Content -->
                        <div style="flex: 1; display: flex; flex-direction: column; overflow: hidden; background: white;">
                            <!-- Tab Buttons -->
                            <div style="display: flex; gap: 4px; background: white; padding: 24px 40px 0 40px; border-bottom: 1px solid #e5e5e5; flex-shrink: 0;">
                                <button class="device-setup-tab active" data-tab="configuration" style="padding: 10px 16px; border: none; border-bottom: 2px solid #1a1a1a; background: transparent; cursor: pointer; font-size: 14px; font-weight: 500; color: #1a1a1a; transition: all 0.2s;">
                                    Configuration
                                </button>
                                <button class="device-setup-tab" data-tab="parameters" style="padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 14px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                    Parameters
                                </button>
                                <button class="device-setup-tab" data-tab="manufacture" style="display: none; padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 14px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                    Manufacture
                                </button>
                            </div>

                            <!-- Configuration Tab Content -->
                            <div class="device-setup-tab-content active" id="deviceSetupConfigTab" style="flex: 1; overflow-y: auto; padding: 32px 40px; display: block; background: white;">
                                <div id="deviceSetupConfig">
                                    <div style="text-align: center; padding: 80px 20px; color: #6c757d;">
                                        <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.3;">üîß</div>
                                        <p style="font-size: 15px; font-weight: 500; color: #404040;">ÎîîÎ∞îÏù¥Ïä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                                        <p style="font-size: 13px; margin-top: 6px; color: #999;">ÏôºÏ™ΩÏóêÏÑú ÎîîÎ∞îÏù¥Ïä§Î•º ÏÑ†ÌÉùÌïòÎ©¥ ÏÑ§Ï†ïÏùÑ Î≥ÄÍ≤ΩÌï† Ïàò ÏûàÏäµÎãàÎã§</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Parameters Tab Content -->
                            <div class="device-setup-tab-content" id="deviceSetupParamsTab" style="flex: 1; padding: 32px 40px; display: none; background: white; overflow: hidden;">
                                <div id="deviceSetupParams" style="display: flex; flex-direction: column; height: 100%;">
                                    <!-- Header with Actions -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-shrink: 0;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <h2 style="margin: 0; font-size: 18px; font-weight: 600;">Parameter List</h2>
                                            <button id="paramReadAllBtn" class="btn btn-success btn-sm" disabled>üìñ Read All</button>
                                        </div>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <div class="csv-import-group">
                                                <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                                                <button id="importCsvBtn" class="btn btn-secondary btn-sm">üì• Import CSV</button>
                                                <button id="exportCsvBtn" class="btn btn-secondary btn-sm">üì§ Export CSV</button>
                                                <button id="loadDefaultCsvBtn" class="btn btn-info btn-sm">üìã Load Default</button>
                                            </div>
                                            <button id="addParamBtn" class="btn btn-primary btn-sm">+ Add Parameter</button>
                                        </div>
                                    </div>

                                    <!-- Filter Group -->
                                    <div class="param-filter-group" style="margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; flex-shrink: 0;">
                                        <div style="display: flex; gap: 5px;">
                                            <button class="filter-btn active" data-filter="all">All</button>
                                            <button class="filter-btn" data-filter="holding">Holding</button>
                                            <button class="filter-btn" data-filter="input">Input</button>
                                        </div>
                                        <div style="display: flex; gap: 5px;">
                                            <button class="filter-btn" data-implemented="all">All Status</button>
                                            <button class="filter-btn" data-implemented="Y">Implemented</button>
                                            <button class="filter-btn" data-implemented="N">Not Implemented</button>
                                        </div>
                                        <input type="text" id="paramSearchInput" placeholder="Search by name or address..." style="flex: 1; min-width: 200px; padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 13px;">
                                        <span id="paramCount" style="color: #6c757d; font-size: 13px;">0 parameters</span>
                                    </div>

                                    <!-- Parameter List -->
                                    <div id="paramList" class="param-list" style="flex: 1; overflow-y: auto;">
                                        <p class="placeholder">No parameters defined. Click "Import CSV" or "Load Default" to load parameters.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Manufacture Tab Content (Developer Only) -->
                            <div class="device-setup-tab-content" id="deviceSetupManufactureTab" style="flex: 1; padding: 0; display: none; background: white; overflow: hidden; flex-direction: column;">
                                <!-- Sub-tabs -->
                                <div style="display: flex; gap: 4px; background: #f8f9fa; padding: 16px 24px 0 24px; border-bottom: 1px solid #e5e5e5; flex-shrink: 0;">
                                    <button class="manufacture-subtab active" data-subtab="hardware-test" style="padding: 10px 16px; border: none; border-bottom: 2px solid #667eea; background: transparent; cursor: pointer; font-size: 13px; font-weight: 500; color: #667eea; transition: all 0.2s;">
                                        Hardware Test
                                    </button>
                                    <button class="manufacture-subtab" data-subtab="offset" style="padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 13px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                        Offset Setting
                                    </button>
                                    <button class="manufacture-subtab" data-subtab="tuning" style="padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 13px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                        Tuning
                                    </button>
                                    <button class="manufacture-subtab" data-subtab="os-verification" style="padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 13px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                        OS Verification
                                    </button>
                                    <button class="manufacture-subtab" data-subtab="serial-number" style="padding: 10px 16px; border: none; border-bottom: 2px solid transparent; background: transparent; cursor: pointer; font-size: 13px; font-weight: 500; color: #6c757d; transition: all 0.2s;">
                                        Serial Number
                                    </button>
                                </div>

                                <!-- Sub-tab Contents Container -->
                                <div style="flex: 1; overflow-y: auto; background: white;">
                                    <!-- OS Verification Sub-tab -->
                                    <div class="manufacture-subtab-content" id="manufactureOsVerification" style="display: none; height: 100%;">

                                <!-- Progress Summary -->
                                <div style="padding: 24px 32px; background: #f8f9fa; border-bottom: 1px solid #e9ecef;">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 32px; font-weight: 700; color: #1a1a1a;" id="osTestTotal">16</div>
                                            <div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px;">Total Tests</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 32px; font-weight: 700; color: #28a745;" id="osTestPassed">0</div>
                                            <div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px;">Passed</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 32px; font-weight: 700; color: #dc3545;" id="osTestFailed">0</div>
                                            <div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px;">Failed</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 32px; font-weight: 700; color: #6c757d;" id="osTestPending">16</div>
                                            <div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px;">Pending</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 32px; font-weight: 700; color: #667eea;" id="osTestProgress">0%</div>
                                            <div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px;">Progress</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Test Categories -->
                                <div style="padding: 32px;">
                                    <!-- 1. RS485 -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">1. RS485</h3>
                                            <span style="font-size: 12px; color: #6c757d;">1 test</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="rs485-1" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; overflow: hidden; transition: all 0.2s;">
                                                <!-- Test Header (Always Visible) -->
                                                <div class="os-test-header" style="padding: 16px; cursor: pointer; display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">RS485 No. 1 - Node ID ÏÑ§Ï†ï</div>
                                                        <div style="font-size: 12px; color: #6c757d;">RS485 ÌÜµÏã† Í∏∞Î≥∏ Í∏∞Îä• Í≤ÄÏ¶ù</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <span class="test-expand-icon" style="font-size: 18px; color: #6c757d; transition: transform 0.3s;">‚ñº</span>
                                                    </div>
                                                </div>

                                                <!-- Test Content (Expandable) -->
                                                <div class="os-test-content" style="display: none; border-top: 1px solid #e9ecef;">
                                                    <!-- Test Info Section -->
                                                    <div style="padding: 20px; background: #f8f9fa;">
                                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; font-size: 13px;">
                                                            <div>
                                                                <div style="color: #6c757d; margin-bottom: 4px;">ÏãúÌóò Î∂ÑÎ•ò</div>
                                                                <div style="color: #1a1a1a; font-weight: 500;" class="test-category">RS485</div>
                                                            </div>
                                                            <div>
                                                                <div style="color: #6c757d; margin-bottom: 4px;">ÏãúÌóò Î≤àÌò∏</div>
                                                                <div style="color: #1a1a1a; font-weight: 500;" class="test-number">1</div>
                                                            </div>
                                                            <div style="grid-column: 1 / -1;">
                                                                <div style="color: #6c757d; margin-bottom: 4px;">ÏãúÌóò Î™©Ï†Å</div>
                                                                <div style="color: #1a1a1a;" class="test-purpose">ÏòàÏßÄÎ≥¥Ï†Ñ Ìà¥ÏùÑ Ïù¥Ïö©Ìï¥ Node ID ÏÑ§Ï†ïÏù¥ ÎêòÎäîÏßÄ ÌôïÏù∏ÌïúÎã§</div>
                                                            </div>
                                                            <div>
                                                                <div style="color: #6c757d; margin-bottom: 4px;">Ï†ÅÏö© Î™®Îç∏</div>
                                                                <div style="color: #1a1a1a;" class="test-model">EC-FAN</div>
                                                            </div>
                                                            <div>
                                                                <div style="color: #6c757d; margin-bottom: 4px;">ÏãúÌóò Ïû•ÎπÑ</div>
                                                                <div style="color: #1a1a1a;" class="test-equipment">EC FAN 1EA, USB to RS485 Converter</div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- Test Control Section -->
                                                    <div style="padding: 20px; background: #f8f9fa; border-top: 1px solid #e9ecef;">
                                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                                                            <h4 style="margin: 0; font-size: 15px; font-weight: 600;">ÌÖåÏä§Ìä∏ Ïã§Ìñâ</h4>
                                                            <div style="display: flex; gap: 8px;">
                                                                <button class="btn btn-primary btn-sm test-start-btn">‚ñ∂ Start Test</button>
                                                                <button class="btn btn-secondary btn-sm test-stop-btn" style="display: none;">‚èπ Stop</button>
                                                            </div>
                                                        </div>
                                                        <div style="background: #e9ecef; height: 6px; border-radius: 3px; overflow: hidden;">
                                                            <div class="test-progress-bar" style="height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); width: 0%; transition: width 0.3s;"></div>
                                                        </div>
                                                        <div class="test-progress-text" style="margin-top: 6px; font-size: 12px; color: #6c757d; text-align: center;">
                                                            ÌÖåÏä§Ìä∏Î•º ÏãúÏûëÌïòÎ†§Î©¥ Start Test Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî
                                                        </div>
                                                    </div>

                                                    <!-- Test Steps Section -->
                                                    <div style="padding: 20px;">
                                                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">ÏãúÌóò Îã®Í≥Ñ</h4>
                                                        <div class="test-steps-list" style="display: flex; flex-direction: column; gap: 8px;">
                                                            <!-- Steps will be dynamically added here -->
                                                        </div>
                                                    </div>

                                                    <!-- Test Log Section -->
                                                    <div style="padding: 0 20px 20px 20px;">
                                                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">Ïã§Ìñâ Î°úÍ∑∏</h4>
                                                        <div class="test-log-container" style="background: #1e1e1e; color: #d4d4d4; padding: 12px; border-radius: 4px; font-family: 'Consolas', 'Monaco', monospace; font-size: 11px; max-height: 250px; overflow-y: auto; line-height: 1.5;">
                                                            <div style="color: #6c757d;">ÌÖåÏä§Ìä∏ Î°úÍ∑∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</div>
                                                        </div>
                                                    </div>

                                                    <!-- Criteria Section -->
                                                    <div style="padding: 0 20px 20px 20px;">
                                                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">ÌåêÏ†ï Í∏∞Ï§Ä</h4>
                                                        <div style="padding: 12px; background: #e7f3ff; border-left: 4px solid #2196f3; border-radius: 4px;">
                                                            <div style="font-size: 13px; color: #1a1a1a;" class="test-criteria">ÏÑ§Ï†ï Node ID ÏûÖÎ†• Ïãú Device, SW Ver, Boot Ver Ï∂úÎ†•</div>
                                                        </div>
                                                    </div>

                                                    <!-- Notes Section -->
                                                    <div style="padding: 0 20px 20px 20px;">
                                                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">ÎπÑÍ≥† / Î©îÎ™®</h4>
                                                        <textarea class="test-notes" placeholder="ÌÖåÏä§Ìä∏ Ï§ë Î∞úÍ≤¨Ìïú ÏÇ¨Ìï≠Ïù¥ÎÇò Î©îÎ™®Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."
                                                            style="width: 100%; min-height: 70px; padding: 10px; border: 1px solid #e9ecef; border-radius: 4px; font-family: inherit; font-size: 13px; resize: vertical;"></textarea>
                                                    </div>

                                                    <!-- Result Section -->
                                                    <div style="padding: 20px; background: #f8f9fa; border-top: 1px solid #e9ecef;">
                                                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h4>
                                                        <div class="test-result-display" style="display: none;">
                                                            <!-- Auto result will be displayed here -->
                                                        </div>
                                                        <div class="test-result-pending" style="padding: 12px; background: #e9ecef; border-radius: 4px; text-align: center; color: #6c757d; font-size: 13px;">
                                                            ÌÖåÏä§Ìä∏Î•º Ïã§ÌñâÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä ÏûêÎèôÏúºÎ°ú ÌëúÏãúÎê©ÎãàÎã§
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- 2. Modbus RTU -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">2. Modbus RTU</h3>
                                            <span style="font-size: 12px; color: #6c757d;">3 tests</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="modbus-1" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Modbus No. 1</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Modbus RTU ÌîÑÎ°úÌÜ†ÏΩú Í∏∞Î≥∏ Í∏∞Îä•</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="modbus-2" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Modbus No. 2</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Î†àÏßÄÏä§ÌÑ∞ ÏùΩÍ∏∞/Ïì∞Í∏∞ Í∏∞Îä•</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="modbus-3" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Modbus No. 3</div>
                                                        <div style="font-size: 12px; color: #6c757d;">ÏóêÎü¨ Ï≤òÎ¶¨ Î∞è ÏòàÏô∏ ÏÉÅÌô©</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- 3. Open-loop Control -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">3. Open-loop Control</h3>
                                            <span style="font-size: 12px; color: #6c757d;">1 test</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="openloop-1" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Open-loop Control No. 1</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Í∞úÎ∞©Ìòï Ï†úÏñ¥ Î™®Îìú ÎèôÏûë</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- 4. Closed loop Velocity Control -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">4. Closed loop Velocity Control</h3>
                                            <span style="font-size: 12px; color: #6c757d;">1 test</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="closedloop-1" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Closed-loop Velocity Control No. 1</div>
                                                        <div style="font-size: 12px; color: #6c757d;">ÌèêÎ£®ÌîÑ ÏÜçÎèÑ Ï†úÏñ¥ Í∏∞Îä•</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- 5. Í∏∞Î≥∏ ÎèôÏûë -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">5. Í∏∞Î≥∏ ÎèôÏûë</h3>
                                            <span style="font-size: 12px; color: #6c757d;">4 tests</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="basic-1" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Í∏∞Î≥∏ÎèôÏûë No. 1 - OS Îã§Ïö¥Î°úÎìú</div>
                                                        <div style="font-size: 12px; color: #6c757d;">ÌéåÏõ®Ïñ¥ Îã§Ïö¥Î°úÎìú Í∏∞Îä•</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="basic-2" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Í∏∞Î≥∏ÎèôÏûë No. 2 - OS Îã§Ïö¥Î°úÎìú Ï§ë Î∂ÑÎ¶¨</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Îã§Ïö¥Î°úÎìú Ï§ëÎã® Ï≤òÎ¶¨</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="basic-3" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Í∏∞Î≥∏ÎèôÏûë No. 3 - ÌöåÏ†Ñ Î∞©Ìñ•</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Ï†ï/Ïó≠ ÌöåÏ†Ñ Î∞©Ìñ• Ï†úÏñ¥</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="basic-4" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Í∏∞Î≥∏ÎèôÏûë No. 4 - Ïó≠Î∞©Ìñ• Ïô∏Î†• ÌöåÏ†Ñ ÏñµÏ†ú</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Ïô∏Î†• ÏñµÏ†ú Í∏∞Îä•</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- 6. Î≥¥Ìò∏ ÎèôÏûë -->
                                    <section style="margin-bottom: 32px;">
                                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #1a1a1a;">6. Î≥¥Ìò∏ ÎèôÏûë</h3>
                                            <span style="font-size: 12px; color: #6c757d;">6 tests</span>
                                        </div>
                                        <div style="display: grid; gap: 12px;">
                                            <div class="os-test-item" data-test-id="protection-1" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 1 - Ï£º Ï†ÑÏõê Í≤∞ÏÉÅ Î≥¥Ìò∏</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Ï†ÑÏõê Í≤∞ÏÉÅ Í∞êÏßÄ Î∞è Î≥¥Ìò∏</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="protection-2" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 2 - ÏóîÏΩîÎçî Ïã†Ìò∏ Ïù¥ÏÉÅ Î≥¥Ìò∏</div>
                                                        <div style="font-size: 12px; color: #6c757d;">ÏóîÏΩîÎçî Ïò§Î•ò Í∞êÏßÄ</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="protection-3" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 3 - Î™®ÌÑ∞ Íµ¨ÏÜç Î≥¥Ìò∏</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Î™®ÌÑ∞ ÎùΩ Í∞êÏßÄ Î∞è Ï†ïÏßÄ</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="protection-4" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 4 - Í≥ºÏÜç Î≥¥Ìò∏</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Í≥ºÏÜç Í∞êÏßÄ Î∞è Ï†úÌïú</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="protection-5" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 5 - ÏóîÏΩîÎçî Î≥¥Ï†ï ÏóêÎü¨</div>
                                                        <div style="font-size: 12px; color: #6c757d;">ÏóîÏΩîÎçî Ï∫òÎ¶¨Î∏åÎ†àÏù¥ÏÖò Ïò§Î•ò</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="os-test-item" data-test-id="protection-6" style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Î≥¥Ìò∏ÎèôÏûë No. 6 - Ï†Ä Ï†ÑÏïï ÏóêÎü¨</div>
                                                        <div style="font-size: 12px; color: #6c757d;">Ï†ÄÏ†ÑÏïï Í∞êÏßÄ Î∞è Î≥¥Ìò∏</div>
                                                    </div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <span class="test-status-badge" style="padding: 4px 12px; background: #e9ecef; color: #6c757d; border-radius: 12px; font-size: 12px; font-weight: 500;">Pending</span>
                                                        <button class="btn btn-primary btn-sm test-run-btn">Run Test</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <!-- Action Buttons -->
                                    <div style="display: flex; justify-content: center; gap: 12px; margin-top: 40px; padding-top: 32px; border-top: 1px solid #e9ecef;">
                                        <button class="btn btn-success" id="osRunAllTestsBtn" style="padding: 12px 32px;">‚ñ∂ Run All Tests</button>
                                        <button class="btn btn-warning" id="osResetTestsBtn" style="padding: 12px 32px;">‚Ü∫ Reset All</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Hardware Test Sub-tab -->
                            <div class="manufacture-subtab-content active" id="manufactureHardwareTest" style="display: block; padding: 32px;">
                                        <div style="text-align: center; padding: 80px 20px; color: #6c757d;">
                                            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.3;">üîß</div>
                                            <p style="font-size: 15px; font-weight: 500; color: #404040;">Hardware Test</p>
                                            <p style="font-size: 13px; margin-top: 6px; color: #999;">ÌïòÎìúÏõ®Ïñ¥ Í≤ÄÏÇ¨ Í∏∞Îä• (Ï§ÄÎπÑ Ï§ë)</p>
                                        </div>
                                    </div>

                                    <!-- Tuning Sub-tab -->
                                    <div class="manufacture-subtab-content" id="manufactureTuning" style="display: none; padding: 32px;">
                                        <div style="text-align: center; padding: 80px 20px; color: #6c757d;">
                                            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.3;">‚öôÔ∏è</div>
                                            <p style="font-size: 15px; font-weight: 500; color: #404040;">Tuning</p>
                                            <p style="font-size: 13px; margin-top: 6px; color: #999;">Î™®ÌÑ∞ ÌäúÎãù Í∏∞Îä• (Ï§ÄÎπÑ Ï§ë)</p>
                                        </div>
                                    </div>

                                    <!-- Offset Setting Sub-tab -->
                                    <div class="manufacture-subtab-content" id="manufactureOffset" style="display: none; padding: 32px;">
                                        <div style="text-align: center; padding: 80px 20px; color: #6c757d;">
                                            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.3;">üìê</div>
                                            <p style="font-size: 15px; font-weight: 500; color: #404040;">Offset Setting</p>
                                            <p style="font-size: 13px; margin-top: 6px; color: #999;">Offset Í∞í ÏÑ§Ï†ï (Ï§ÄÎπÑ Ï§ë)</p>
                                        </div>
                                    </div>

                                    <!-- Serial Number Sub-tab -->
                                    <div class="manufacture-subtab-content" id="manufactureSerialNumber" style="display: none; padding: 32px;">
                                        <div style="text-align: center; padding: 80px 20px; color: #6c757d;">
                                            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.3;">üè∑Ô∏è</div>
                                            <p style="font-size: 15px; font-weight: 500; color: #404040;">Serial Number</p>
                                            <p style="font-size: 13px; margin-top: 6px; color: #999;">ÏãúÎ¶¨Ïñº ÎÑòÎ≤Ñ Î∂ÄÏó¨ (Ï§ÄÎπÑ Ï§ë)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>

                <!-- Modbus Page -->
                <div id="page-modbus" class="page-content">
                    <div style="height: 100%; display: flex; align-items: flex-start; justify-content: center; padding: 40px 20px;">
                        <div style="display: flex; flex-direction: column; width: 100%; max-width: 900px; height: fit-content; max-height: calc(100vh - 180px); overflow: hidden; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">

                            <!-- Header -->
                            <div style="padding: 24px 40px; border-bottom: 1px solid #e9ecef;">
                                <div style="font-size: 24px; font-weight: 600; color: #1a1a1a; margin-bottom: 4px;">Modbus Configuration</div>
                                <div style="font-size: 14px; color: #6c757d;">Manual Modbus RTU communication test</div>
                            </div>

                            <!-- Content -->
                            <div style="flex: 1; overflow-y: auto; padding: 32px 40px;">
                                <div style="max-width: 900px;">
                                    <!-- Slave ID -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #e9ecef;">
                                        <div style="flex: 1; padding-right: 40px;">
                                            <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Slave ID</div>
                                            <div style="font-size: 13px; color: #6c757d;">Target device address (1-247 or hex)</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; gap: 4px; min-width: 300px;">
                                            <input type="text" id="slaveId" value="1" placeholder="1 or D"
                                                style="width: 100%; padding: 7px 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: white;">
                                            <small class="input-converted" id="slaveId-converted" style="font-size: 12px; color: #6c757d; min-height: 16px;"></small>
                                        </div>
                                    </div>

                                    <!-- Function Code -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #e9ecef;">
                                        <div style="flex: 1; padding-right: 40px;">
                                            <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Function Code</div>
                                            <div style="font-size: 13px; color: #6c757d;">Modbus function to execute</div>
                                        </div>
                                        <div style="min-width: 300px;">
                                            <select id="functionCode"
                                                style="width: 100%; padding: 7px 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: white;">
                                                <option value="1">01 - Read Coils</option>
                                                <option value="2">02 - Read Discrete Inputs</option>
                                                <option value="3" selected>03 - Read Holding Registers</option>
                                                <option value="4">04 - Read Input Registers</option>
                                                <option value="5">05 - Write Single Coil</option>
                                                <option value="6">06 - Write Single Register</option>
                                                <option value="15">15 - Write Multiple Coils</option>
                                                <option value="16">16 - Write Multiple Registers</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Start Address -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #e9ecef;">
                                        <div style="flex: 1; padding-right: 40px;">
                                            <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Start Address</div>
                                            <div style="font-size: 13px; color: #6c757d;">Starting register/coil address (decimal or hex)</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; gap: 4px; min-width: 300px;">
                                            <input type="text" id="startAddress" value="0" placeholder="0 or D011"
                                                style="width: 100%; padding: 7px 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: white;">
                                            <small class="input-converted" id="startAddress-converted" style="font-size: 12px; color: #6c757d; min-height: 16px;"></small>
                                        </div>
                                    </div>

                                    <!-- Quantity -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #e9ecef;">
                                        <div style="flex: 1; padding-right: 40px;">
                                            <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Quantity</div>
                                            <div style="font-size: 13px; color: #6c757d;">Number of registers/coils to read</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; gap: 4px; min-width: 300px;">
                                            <input type="text" id="quantity" value="10" placeholder="10 or A"
                                                style="width: 100%; padding: 7px 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: white;">
                                            <small class="input-converted" id="quantity-converted" style="font-size: 12px; color: #6c757d; min-height: 16px;"></small>
                                        </div>
                                    </div>

                                    <!-- Write Value -->
                                    <div id="writeValueGroup" style="display: none;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #e9ecef;">
                                            <div style="flex: 1; padding-right: 40px;">
                                                <div style="font-size: 14px; font-weight: 500; color: #1a1a1a; margin-bottom: 4px;">Write Value</div>
                                                <div style="font-size: 13px; color: #6c757d;">Value to write (decimal or hex)</div>
                                            </div>
                                            <div style="display: flex; flex-direction: column; gap: 4px; min-width: 300px;">
                                                <input type="text" id="writeValue" value="0" placeholder="0 or 3E8"
                                                    style="width: 100%; padding: 7px 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: white;">
                                                <small class="input-converted" id="writeValue-converted" style="font-size: 12px; color: #6c757d; min-height: 16px;"></small>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Send Button -->
                                    <div style="display: flex; justify-content: flex-end; padding: 24px 0 0 0;">
                                        <button id="sendBtn" class="btn btn-success" disabled
                                            style="padding: 10px 24px; font-size: 14px; border-radius: 6px; min-width: 140px;">
                                            Send Request
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Parameters Page (moved to Device - Parameters tab) -->
                <div id="page-parameters" class="page-content" style="display: none !important;">
                    <section class="card">
                        <!-- Device Selector (Collapsible) -->
                        <div class="param-device-selector">
                            <div class="param-device-selector-header" id="paramDeviceSelectorHeader">
                                <div class="param-device-header-left">
                                    <span class="param-device-toggle-icon" id="paramDeviceToggleIcon">‚ñº</span>
                                    <span class="param-device-label">Target Device:</span>
                                    <span class="param-device-selected" id="paramDeviceSelectedName">ÏÑ†ÌÉù ÏïàÎê®</span>
                                </div>
                                <button id="paramReadAllBtn" class="btn btn-success btn-sm" disabled>üìñ Read All</button>
                            </div>
                            <div class="param-device-radio-group" id="paramDeviceRadioGroup">
                                <div class="param-device-placeholder">
                                    <span>üì¶</span> DashboardÏóêÏÑú ÎîîÎ∞îÏù¥Ïä§Î•º Îì±Î°ùÌïòÏÑ∏Ïöî
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-shrink: 0;">
                            <h2 style="margin-bottom: 0;">Parameter List</h2>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <div class="csv-import-group">
                                    <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                                    <button id="importCsvBtn" class="btn btn-secondary btn-sm">üì• Import CSV</button>
                                    <button id="exportCsvBtn" class="btn btn-secondary btn-sm">üì§ Export CSV</button>
                                    <button id="loadDefaultCsvBtn" class="btn btn-info btn-sm">üìã Load Default</button>
                                </div>
                                <button id="addParamBtn" class="btn btn-primary btn-sm">+ Add Parameter</button>
                            </div>
                        </div>
                        <div class="param-filter-group" style="margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                            <div style="display: flex; gap: 5px;">
                                <button class="filter-btn active" data-filter="all">All</button>
                                <button class="filter-btn" data-filter="holding">Holding</button>
                                <button class="filter-btn" data-filter="input">Input</button>
                            </div>
                            <div style="display: flex; gap: 5px;">
                                <button class="filter-btn" data-implemented="all">All Status</button>
                                <button class="filter-btn" data-implemented="Y">Implemented</button>
                                <button class="filter-btn" data-implemented="N">Not Implemented</button>
                            </div>
                            <input type="text" id="paramSearchInput" placeholder="Search by name or address..." style="flex: 1; min-width: 200px; padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 13px;">
                            <span id="paramCount" style="color: #6c757d; font-size: 13px;">0 parameters</span>
                        </div>
                        <div id="paramList" class="param-list">
                            <p class="placeholder">No parameters defined. Click "Import CSV" or "Load Default" to load parameters.</p>
                        </div>
                    </section>
                </div>

                <!-- Settings Page (removed, now using modal) -->
                <div id="page-settings" class="page-content" style="display:none;">
                    <div class="settings-container">
                        <!-- Statistics Settings Section -->
                        <section class="card setting-section" id="setting-statistics" style="display: none;">
                            <h2>Statistics Settings</h2>
                            <p style="color: #6c757d; margin-bottom: 20px;">
                                ÌÜµÍ≥Ñ Í≥ÑÏÇ∞ Î∞è ÌëúÏãú Î∞©Î≤ïÏùÑ ÏÑ§Ï†ïÌï©ÎãàÎã§.
                            </p>
                            <div class="form-group" style="max-width: 400px;">
                                <label for="baseFrameCount">Í∏∞Ï§Ä ÌîÑÎ†àÏûÑ Ïàò (Error Rate Í≥ÑÏÇ∞)</label>
                                <input type="number" id="baseFrameCount" min="100" max="10000" value="1000" step="100">
                                <small style="color: #6c757d; margin-top: 5px; display: block;">
                                    ÏóêÎü¨Ïú®ÏùÑ Í≥ÑÏÇ∞Ìï† Îïå ÏÇ¨Ïö©Ìï† Í∏∞Ï§Ä ÌîÑÎ†àÏûÑ ÏàòÏûÖÎãàÎã§. Ïòà: 1000 ÌîÑÎ†àÏûÑÎãπ Î™á Í∞úÏùò ÏóêÎü¨Í∞Ä Î∞úÏÉùÌïòÎäîÏßÄ Í≥ÑÏÇ∞Ìï©ÎãàÎã§.
                                </small>
                            </div>
                        </section>

                        <!-- Simulator Settings Section -->
                        <section class="card setting-section" id="setting-simulator" style="display: none;">
                            <h2>Virtual Slave Simulator</h2>
                            <p style="color: #6c757d; margin-bottom: 20px;">
                                Ïã§Ï†ú Modbus Ïû•ÎπÑ ÏóÜÏù¥ ÌÖåÏä§Ìä∏Ìï† Ïàò ÏûàÎäî Í∞ÄÏÉÅ Ïä¨Î†àÏù¥Î∏å Ïû•ÏπòÏûÖÎãàÎã§.
                                ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Î•º ÌôúÏÑ±ÌôîÌïòÎ©¥ Ïã§Ï†ú ÏãúÎ¶¨Ïñº Ìè¨Ìä∏ Ïó∞Í≤∞ ÏóÜÏù¥ Modbus ÌÜµÏã†ÏùÑ ÌÖåÏä§Ìä∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                            </p>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <div class="form-group">
                                        <label>ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÉÅÌÉú</label>
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <button id="simToggleBtn" class="btn btn-primary">ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÌôúÏÑ±Ìôî</button>
                                            <span id="simStatus" style="color: #6c757d;">ÎπÑÌôúÏÑ±</span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="simSlaveId">Í∞ÄÏÉÅ Slave ID</label>
                                        <input type="number" id="simSlaveId" min="1" max="247" value="1">
                                    </div>

                                    <div class="form-group">
                                        <label for="simDelay">ÏùëÎãµ ÏßÄÏó∞ (ms)</label>
                                        <input type="number" id="simDelay" min="0" max="1000" value="50" step="10">
                                    </div>

                                    <button id="simResetBtn" class="btn btn-warning">Î©îÎ™®Î¶¨ Ï¥àÍ∏∞Ìôî</button>
                                </div>

                                <div>
                                    <h3 style="font-size: 14px; margin-bottom: 10px; color: #495057;">ÏãúÎÆ¨Î†àÏù¥ÏÖò Îç∞Ïù¥ÌÑ∞</h3>
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; font-family: 'Consolas', monospace; font-size: 12px;">
                                        <div style="margin-bottom: 10px;">
                                            <strong>Holding Registers:</strong><br>
                                            [0] Ïò®ÎèÑ: <span id="simTemp">--</span><br>
                                            [1] ÏäµÎèÑ: <span id="simHumid">--</span><br>
                                            [2] ÏïïÎ†•: <span id="simPress">--</span><br>
                                            [3] Ï†ÑÏïï: <span id="simVolt">--</span><br>
                                            [5] ÏÜçÎèÑ: <span id="simSpeed">--</span> RPM
                                        </div>
                                        <div>
                                            <strong>Coils:</strong><br>
                                            [0] ÏãúÏä§ÌÖú ÎèôÏûë: <span id="simCoil0">--</span><br>
                                            [1] ÏïåÎûå: <span id="simCoil1">--</span><br>
                                            [2] Ï§ÄÎπÑ: <span id="simCoil2">--</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #e7f3ff; padding: 15px; border-radius: 4px; border-left: 4px solid #007bff;">
                                <strong>ÏÇ¨Ïö© Î∞©Î≤ï:</strong>
                                <ol style="margin: 10px 0 0 20px; color: #495057;">
                                    <li>ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Î•º ÌôúÏÑ±ÌôîÌï©ÎãàÎã§</li>
                                    <li>DashboardÎ°ú ÎèåÏïÑÍ∞ÄÏÑú "Connect" ÎåÄÏã† Í∞ÄÏÉÅ Ïó∞Í≤∞ÏùÑ ÏÇ¨Ïö©Ìï©ÎãàÎã§</li>
                                    <li>ÏùºÎ∞ò Modbus Î™ÖÎ†πÏùÑ Ï†ÑÏÜ°ÌïòÎ©¥ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Í∞Ä ÏùëÎãµÌï©ÎãàÎã§</li>
                                    <li>Îç∞Ïù¥ÌÑ∞Îäî Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î≥ÄÌôîÌïòÏó¨ Ïã§Ï†ú Ïû•ÎπÑÎ•º ÏãúÎÆ¨Î†àÏù¥ÏÖòÌï©ÎãàÎã§</li>
                                </ol>
                            </div>
                        </section>

                        <!-- External Tools Section -->
                        <section class="card setting-section" id="setting-external" style="display: none;">
                            <h2>Ïô∏Î∂Ä ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÇ¨Ïö©</h2>
                            <p style="color: #6c757d; margin-bottom: 15px;">
                                Îçî Ï†ïÍµêÌïú ÌÖåÏä§Ìä∏Î•º ÏúÑÌï¥ Ïô∏Î∂Ä Modbus ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§:
                            </p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">
                                <h3 style="font-size: 14px; margin-bottom: 10px;">Ï∂îÏ≤ú ÌîÑÎ°úÍ∑∏Îû®:</h3>
                                <ul style="margin-left: 20px; color: #495057;">
                                    <li><strong>Modbus Poll / Slave</strong> - Í∞ÄÏû• ÎÑêÎ¶¨ ÏÇ¨Ïö©ÎêòÎäî ÏÉÅÏö© ÌîÑÎ°úÍ∑∏Îû®</li>
                                    <li><strong>pyModSlave</strong> - Î¨¥Î£å Python Í∏∞Î∞ò ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</li>
                                    <li><strong>com0com + Virtual Serial Port</strong> - Í∞ÄÏÉÅ ÏãúÎ¶¨Ïñº Ìè¨Ìä∏ Ïåç ÏÉùÏÑ±</li>
                                    <li><strong>ModRSsim2</strong> - Î¨¥Î£å Modbus RTU/TCP ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</li>
                                </ul>
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Firmware Page -->
                <div id="page-firmware" class="page-content">
                    <div class="firmware-container">
                        <div class="firmware-header">
                            <h2>Firmware Download</h2>
                            <p class="firmware-subtitle">Modbus Function Code 0x66ÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Ïû•ÏπòÏóê ÌéåÏõ®Ïñ¥Î•º ÏóÖÎ°úÎìúÌï©ÎãàÎã§</p>
                        </div>

                        <!-- File Upload Section -->
                        <div class="firmware-upload-section">
                            <div class="firmware-dropzone" id="firmwareDropzone">
                                <div class="dropzone-content">
                                    <div class="dropzone-icon">üìÅ</div>
                                    <div class="dropzone-text">
                                        <p class="dropzone-main">ÌååÏùºÏùÑ Ïó¨Í∏∞Ïóê ÎìúÎûòÍ∑∏ÌïòÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                                        <p class="dropzone-sub">ÏßÄÏõê ÌòïÏãù: .bin, .hex, .fw</p>
                                    </div>
                                    <input type="file" id="firmwareFileInput" accept=".bin,.hex,.fw" hidden>
                                    <button class="btn btn-primary" id="firmwareSelectBtn">ÌååÏùº ÏÑ†ÌÉù</button>
                                </div>
                            </div>
                        </div>

                        <!-- Selected File Info -->
                        <div class="firmware-file-info" id="firmwareFileInfo" style="display: none;">
                            <div class="file-info-header">
                                <span class="file-icon">üìÑ</span>
                                <div class="file-details">
                                    <span class="file-name" id="firmwareFileName">-</span>
                                    <span class="file-size" id="firmwareFileSize">-</span>
                                </div>
                                <button class="file-remove-btn" id="firmwareRemoveBtn" title="ÌååÏùº Ï†úÍ±∞">√ó</button>
                            </div>
                        </div>

                        <!-- Device Selection -->
                        <div class="firmware-device-section">
                            <h3>ÎåÄÏÉÅ Ïû•Ïπò ÏÑ†ÌÉù</h3>
                            <div class="firmware-device-row">
                                <div class="firmware-device-list" id="firmwareDeviceList">
                                    <p class="placeholder">Ïó∞Í≤∞Îêú Ïû•ÏπòÍ∞Ä ÏóÜÏäµÎãàÎã§</p>
                                </div>
                                <div class="firmware-slave-direct">
                                    <label for="firmwareSlaveId">Slave ID ÏßÅÏ†ë ÏûÖÎ†•:</label>
                                    <input type="number" id="firmwareSlaveId" min="1" max="247" value="1">
                                </div>
                            </div>
                        </div>

                        <!-- Protocol Settings -->
                        <div class="firmware-settings-section">
                            <h3>ÌîÑÎ°úÌÜ†ÏΩú ÏÑ§Ï†ï</h3>
                            <div class="firmware-settings-grid">
                                <div class="form-group">
                                    <label for="fwPacketSize">Ìå®ÌÇ∑ ÌÅ¨Í∏∞ (bytes)</label>
                                    <select id="fwPacketSize">
                                        <option value="32">32 bytes</option>
                                        <option value="60" selected>60 bytes (Í∂åÏû•)</option>
                                        <option value="64">64 bytes</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="fwPacketDelay">Ìå®ÌÇ∑ Í∞ÑÍ≤© (ms)</label>
                                    <input type="number" id="fwPacketDelay" min="10" max="500" value="50">
                                </div>
                                <div class="form-group">
                                    <label for="fwResponseTimeout">ÏùëÎãµ ÎåÄÍ∏∞ (ms)</label>
                                    <input type="number" id="fwResponseTimeout" min="100" max="5000" value="1000">
                                </div>
                            </div>
                        </div>

                        <!-- Update Step Indicators -->
                        <div class="firmware-steps-section" id="firmwareStepsSection">
                            <h3>ÏóÖÎç∞Ïù¥Ìä∏ Îã®Í≥Ñ</h3>
                            <div class="firmware-steps">
                                <div class="firmware-step" id="fwStep0x90" data-step="0x90">
                                    <div class="step-indicator">
                                        <span class="step-number">1</span>
                                        <span class="step-status-icon"></span>
                                    </div>
                                    <div class="step-content">
                                        <div class="step-title">Ï¥àÍ∏∞Ìôî (0x90)</div>
                                        <div class="step-desc">Flash Unlock, ÌååÏùº ÌÅ¨Í∏∞ Ï†ÑÏÜ°</div>
                                    </div>
                                </div>
                                <div class="firmware-step" id="fwStep0x91" data-step="0x91">
                                    <div class="step-indicator">
                                        <span class="step-number">2</span>
                                        <span class="step-status-icon"></span>
                                    </div>
                                    <div class="step-content">
                                        <div class="step-title">Erase ÌôïÏù∏ (0x91)</div>
                                        <div class="step-desc">Flash Erase ÏôÑÎ£å ÌôïÏù∏ (0x55555555)</div>
                                    </div>
                                </div>
                                <div class="firmware-step" id="fwStep0x03" data-step="0x03">
                                    <div class="step-indicator">
                                        <span class="step-number">3</span>
                                        <span class="step-status-icon"></span>
                                    </div>
                                    <div class="step-content">
                                        <div class="step-title">Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ° (0x03)</div>
                                        <div class="step-desc">ÌéåÏõ®Ïñ¥ Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°</div>
                                        <div class="step-progress" id="fwDataProgress">
                                            <div class="step-progress-bar">
                                                <div class="step-progress-fill" id="fwDataProgressFill"></div>
                                            </div>
                                            <div class="step-progress-details">
                                                <span class="step-progress-percent" id="fwDataProgressPercent">0%</span>
                                                <span class="step-progress-bytes" id="fwDataProgressBytes">0 / 0 bytes</span>
                                            </div>
                                            <div class="step-progress-stats">
                                                <span class="step-progress-packets" id="fwDataProgressPackets">Ìå®ÌÇ∑: 0 / 0</span>
                                                <span class="step-progress-time" id="fwDataProgressTime">ÎÇ®ÏùÄ ÏãúÍ∞Ñ: --:--</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="firmware-step" id="fwStep0x99" data-step="0x99">
                                    <div class="step-indicator">
                                        <span class="step-number">4</span>
                                        <span class="step-status-icon"></span>
                                    </div>
                                    <div class="step-content">
                                        <div class="step-title">ÏôÑÎ£å (0x99)</div>
                                        <div class="step-desc">Flash Lock, ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Download Progress -->
                        <div class="firmware-progress-section" id="firmwareProgressSection" style="display: none;">
                            <h3>ÌÜµÏã† Î°úÍ∑∏</h3>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="firmwareProgressBar" style="width: 0%"></div>
                                </div>
                                <div class="progress-info">
                                    <span class="progress-percent" id="firmwareProgressPercent">0%</span>
                                    <span class="progress-status" id="firmwareProgressStatus">Ï§ÄÎπÑ Ï§ë...</span>
                                </div>
                            </div>
                            <div class="progress-log" id="firmwareProgressLog"></div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="firmware-actions">
                            <button class="btn btn-secondary" id="firmwareVerifyBtn" disabled>ÌååÏùº Í≤ÄÏ¶ù</button>
                            <button class="btn btn-primary" id="firmwareDownloadBtn" disabled>Îã§Ïö¥Î°úÎìú ÏãúÏûë</button>
                            <button class="btn btn-danger" id="firmwareCancelBtn" style="display: none;">Ï∑®ÏÜå</button>
                        </div>
                    </div>
                </div>

                <!-- Chart Page -->
                <div id="page-chart" class="page-content">
                    <div class="chart-page-container">
                        <!-- Chart Header -->
                        <div class="chart-header">
                            <div class="chart-title-section">
                                <h1>Real-time Chart</h1>
                                <p class="chart-subtitle">4Ï±ÑÎÑê Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î™®ÎãàÌÑ∞ÎßÅ</p>
                            </div>
                            <div class="chart-header-actions">
                                <button id="chartExportCsvBtn" class="btn btn-secondary btn-sm" title="Export to CSV">
                                    <span>üì•</span> CSV
                                </button>
                                <button id="chartExportPngBtn" class="btn btn-secondary btn-sm" title="Export to PNG">
                                    <span>üñº</span> PNG
                                </button>
                            </div>
                        </div>

                        <!-- Mode & Control Panel -->
                        <div class="chart-control-panel">
                            <div class="chart-mode-section">
                                <label class="chart-section-label">Mode</label>
                                <div class="chart-mode-toggle">
                                    <button class="chart-mode-btn active" data-mode="continuous" id="chartModeContinuous">
                                        <span class="mode-icon">‚ñ∂</span>
                                        <span>Continuous</span>
                                    </button>
                                    <button class="chart-mode-btn" data-mode="trigger" id="chartModeTrigger">
                                        <span class="mode-icon">‚ö°</span>
                                        <span>Trigger</span>
                                    </button>
                                </div>
                            </div>

                            <div class="chart-action-section">
                                <button id="chartStartBtn" class="btn btn-success">
                                    <span>‚ñ∂</span> Start
                                </button>
                                <button id="chartStopBtn" class="btn btn-danger" disabled>
                                    <span>‚ñ†</span> Stop
                                </button>
                                <button id="chartClearBtn" class="btn btn-warning">
                                    <span>‚Ü∫</span> Clear
                                </button>
                                <button id="chartPauseBtn" class="btn btn-secondary" disabled>
                                    <span>‚è∏</span> Pause
                                </button>
                            </div>

                            <div class="chart-settings-section">
                                <div class="chart-setting-item">
                                    <label for="chartTimeScale">Time Scale</label>
                                    <select id="chartTimeScale">
                                        <option value="1000">1s</option>
                                        <option value="2000">2s</option>
                                        <option value="5000" selected>5s</option>
                                        <option value="10000">10s</option>
                                        <option value="30000">30s</option>
                                        <option value="60000">1m</option>
                                    </select>
                                </div>
                                <div class="chart-setting-item">
                                    <label for="chartSampleRate">Sample Rate</label>
                                    <select id="chartSampleRate">
                                        <option value="50">50ms</option>
                                        <option value="100" selected>100ms</option>
                                        <option value="200">200ms</option>
                                        <option value="500">500ms</option>
                                        <option value="1000">1s</option>
                                    </select>
                                </div>
                                <div class="chart-setting-item">
                                    <label for="chartBufferSize">Buffer</label>
                                    <select id="chartBufferSize">
                                        <option value="500">500 pts</option>
                                        <option value="1000" selected>1000 pts</option>
                                        <option value="2000">2000 pts</option>
                                        <option value="5000">5000 pts</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Trigger Settings (shown only in trigger mode) -->
                        <div class="chart-trigger-panel" id="chartTriggerPanel" style="display: none;">
                            <div class="trigger-settings-row">
                                <div class="trigger-setting-item">
                                    <label for="triggerChannel">Trigger Channel</label>
                                    <select id="triggerChannel">
                                        <option value="0">CH1</option>
                                        <option value="1">CH2</option>
                                        <option value="2">CH3</option>
                                        <option value="3">CH4</option>
                                    </select>
                                </div>
                                <div class="trigger-setting-item">
                                    <label for="triggerEdge">Edge</label>
                                    <select id="triggerEdge">
                                        <option value="rising">Rising ‚Üë</option>
                                        <option value="falling">Falling ‚Üì</option>
                                        <option value="both">Both ‚Üï</option>
                                    </select>
                                </div>
                                <div class="trigger-setting-item">
                                    <label for="triggerLevel">Level</label>
                                    <input type="number" id="triggerLevel" value="500" min="0" max="65535">
                                </div>
                                <div class="trigger-setting-item">
                                    <label for="triggerPreSamples">Pre-trigger</label>
                                    <input type="number" id="triggerPreSamples" value="100" min="0" max="500">
                                </div>
                                <div class="trigger-setting-item">
                                    <label for="triggerPostSamples">Post-trigger</label>
                                    <input type="number" id="triggerPostSamples" value="400" min="100" max="2000">
                                </div>
                            </div>
                            <div class="trigger-status">
                                <span class="trigger-status-label">Status:</span>
                                <span class="trigger-status-value" id="triggerStatus">Waiting</span>
                            </div>
                        </div>

                        <!-- Channel Configuration -->
                        <div class="chart-channel-panel">
                            <div class="channel-config" data-channel="0">
                                <label class="channel-toggle">
                                    <input type="checkbox" id="chartCh1Enable" checked>
                                    <span class="channel-indicator" style="background: #3498db;"></span>
                                    <span class="channel-name">CH1</span>
                                </label>
                                <div class="channel-address">
                                    <label for="chartCh1Addr">Addr:</label>
                                    <input type="text" id="chartCh1Addr" value="0xD011" placeholder="0x0000">
                                </div>
                                <div class="channel-value">
                                    <span class="channel-current-label">Value:</span>
                                    <span class="channel-current-value" id="chartCh1Value">--</span>
                                </div>
                            </div>
                            <div class="channel-config" data-channel="1">
                                <label class="channel-toggle">
                                    <input type="checkbox" id="chartCh2Enable" checked>
                                    <span class="channel-indicator" style="background: #e74c3c;"></span>
                                    <span class="channel-name">CH2</span>
                                </label>
                                <div class="channel-address">
                                    <label for="chartCh2Addr">Addr:</label>
                                    <input type="text" id="chartCh2Addr" value="0xD001" placeholder="0x0000">
                                </div>
                                <div class="channel-value">
                                    <span class="channel-current-label">Value:</span>
                                    <span class="channel-current-value" id="chartCh2Value">--</span>
                                </div>
                            </div>
                            <div class="channel-config" data-channel="2">
                                <label class="channel-toggle">
                                    <input type="checkbox" id="chartCh3Enable">
                                    <span class="channel-indicator" style="background: #2ecc71;"></span>
                                    <span class="channel-name">CH3</span>
                                </label>
                                <div class="channel-address">
                                    <label for="chartCh3Addr">Addr:</label>
                                    <input type="text" id="chartCh3Addr" value="0x0000" placeholder="0x0000">
                                </div>
                                <div class="channel-value">
                                    <span class="channel-current-label">Value:</span>
                                    <span class="channel-current-value" id="chartCh3Value">--</span>
                                </div>
                            </div>
                            <div class="channel-config" data-channel="3">
                                <label class="channel-toggle">
                                    <input type="checkbox" id="chartCh4Enable">
                                    <span class="channel-indicator" style="background: #f39c12;"></span>
                                    <span class="channel-name">CH4</span>
                                </label>
                                <div class="channel-address">
                                    <label for="chartCh4Addr">Addr:</label>
                                    <input type="text" id="chartCh4Addr" value="0x0000" placeholder="0x0000">
                                </div>
                                <div class="channel-value">
                                    <span class="channel-current-label">Value:</span>
                                    <span class="channel-current-value" id="chartCh4Value">--</span>
                                </div>
                            </div>
                        </div>

                        <!-- Chart Canvas Container -->
                        <div class="chart-canvas-container" id="chartCanvasContainer">
                            <canvas id="mainChart"></canvas>
                            <!-- Cursor Info Overlay -->
                            <div class="chart-cursor-info" id="chartCursorInfo" style="display: none;">
                                <div class="cursor-time" id="cursorTime">--</div>
                                <div class="cursor-values" id="cursorValues"></div>
                            </div>
                            <!-- Zoom Controls -->
                            <div class="chart-zoom-controls">
                                <button class="zoom-btn" id="chartZoomIn" title="Zoom In">+</button>
                                <button class="zoom-btn" id="chartZoomOut" title="Zoom Out">‚àí</button>
                                <button class="zoom-btn" id="chartZoomReset" title="Reset Zoom">‚Ü∫</button>
                                <button class="zoom-btn" id="chartAutoScale" title="Auto Scale Y">‚¨å</button>
                            </div>
                            <!-- Chart Instructions -->
                            <div class="chart-instructions" id="chartInstructions">
                                <span>Wheel: Zoom Y</span>
                                <span>Drag: Pan</span>
                                <span>Double-click: Reset</span>
                            </div>
                        </div>

                        <!-- Chart Info Panel -->
                        <div class="chart-info-panel">
                            <div class="chart-stats">
                                <div class="chart-stat-item">
                                    <span class="stat-label">Samples:</span>
                                    <span class="stat-value" id="chartSampleCount">0</span>
                                </div>
                                <div class="chart-stat-item">
                                    <span class="stat-label">Time Range:</span>
                                    <span class="stat-value" id="chartTimeRange">0s</span>
                                </div>
                                <div class="chart-stat-item">
                                    <span class="stat-label">Status:</span>
                                    <span class="stat-value" id="chartStatus">Stopped</span>
                                </div>
                            </div>
                            <div class="chart-markers" id="chartMarkers">
                                <span class="markers-label">Markers:</span>
                                <span class="markers-info" id="markersInfo">No markers set (Click to add)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manufacture Page (Developer Only) - DEPRECATED: Moved to Device tab -->
                <div id="page-manufacture" class="page-content" style="display: none !important;">
                    <div style="height: 100%; display: flex; align-items: flex-start; justify-content: center; padding: 40px 20px;">
                        <div style="display: flex; flex-direction: column; width: 100%; max-width: 1200px; height: fit-content; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">

                            <!-- Header -->
                            <div style="padding: 24px 40px; border-bottom: 1px solid #e9ecef; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <div style="font-size: 24px; font-weight: 600; color: white; margin-bottom: 4px;">üîß Manufacture Mode</div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.9);">Developer-only configuration and testing tools</div>
                            </div>

                            <!-- Content -->
                            <div style="padding: 32px 40px;">
                                <div style="background: #fff3cd; padding: 15px; border-radius: 4px; margin-bottom: 30px; border-left: 4px solid #ffc107;">
                                    <strong>‚ö†Ô∏è Developer Mode Activated</strong>
                                    <p style="margin: 10px 0 0 0; color: #856404; font-size: 14px;">
                                        Ïù¥ Î©îÎâ¥Îäî Ï†úÏ°∞ Î∞è Í∞úÎ∞ú Î™©Ï†ÅÏúºÎ°úÎßå ÏÇ¨Ïö©Îê©ÎãàÎã§. ÌÖåÏä§Ìä∏ Î∞è ÎîîÎ≤ÑÍπÖ Í∏∞Îä•Ïù¥ Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.
                                    </p>
                                </div>

                                <!-- Manufacturing Tools Section -->
                                <section style="margin-bottom: 30px;">
                                    <h3 style="margin-bottom: 15px; color: #1a1a1a; font-size: 18px;">Manufacturing Tools</h3>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">

                                        <!-- Factory Reset -->
                                        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                                <span style="font-size: 24px;">üè≠</span>
                                                <h4 style="margin: 0; font-size: 16px;">Factory Reset</h4>
                                            </div>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 15px;">
                                                Î™®Îì† ÎîîÎ∞îÏù¥Ïä§Î•º Í≥µÏû• Ï¥àÍ∏∞Ìôî ÏÉÅÌÉúÎ°ú ÎêòÎèåÎ¶ΩÎãàÎã§.
                                            </p>
                                            <button class="btn btn-warning btn-sm">Reset Device</button>
                                        </div>

                                        <!-- Calibration -->
                                        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                                <span style="font-size: 24px;">üìê</span>
                                                <h4 style="margin: 0; font-size: 16px;">Calibration</h4>
                                            </div>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 15px;">
                                                ÏÑºÏÑú Î∞è Î™®ÌÑ∞ Ï∫òÎ¶¨Î∏åÎ†àÏù¥ÏÖòÏùÑ ÏàòÌñâÌï©ÎãàÎã§.
                                            </p>
                                            <button class="btn btn-info btn-sm">Start Calibration</button>
                                        </div>

                                        <!-- Production Test -->
                                        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                                <span style="font-size: 24px;">‚úÖ</span>
                                                <h4 style="margin: 0; font-size: 16px;">Production Test</h4>
                                            </div>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 15px;">
                                                ÏûêÎèôÌôîÎêú ÏÉùÏÇ∞ ÌÖåÏä§Ìä∏Î•º Ïã§ÌñâÌï©ÎãàÎã§.
                                            </p>
                                            <button class="btn btn-success btn-sm">Run Test Suite</button>
                                        </div>

                                        <!-- Serial Number -->
                                        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                                <span style="font-size: 24px;">üè∑Ô∏è</span>
                                                <h4 style="margin: 0; font-size: 16px;">Serial Number</h4>
                                            </div>
                                            <p style="font-size: 13px; color: #6c757d; margin-bottom: 15px;">
                                                ÏãúÎ¶¨Ïñº ÎÑòÎ≤ÑÎ•º Í∏∞Î°ùÌïòÍ≥† Í¥ÄÎ¶¨Ìï©ÎãàÎã§.
                                            </p>
                                            <button class="btn btn-primary btn-sm">Write S/N</button>
                                        </div>

                                    </div>
                                </section>

                                <!-- Debug Tools Section -->
                                <section style="margin-bottom: 30px;">
                                    <h3 style="margin-bottom: 15px; color: #1a1a1a; font-size: 18px;">Debug Tools</h3>
                                    <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                        <div class="form-group" style="margin-bottom: 15px;">
                                            <label style="font-size: 14px; font-weight: 500;">Raw Command Input</label>
                                            <input type="text" placeholder="Enter raw Modbus command (hex)" style="width: 100%; padding: 8px 12px; border: 1px solid #ced4da; border-radius: 4px; font-family: monospace;">
                                        </div>
                                        <button class="btn btn-primary btn-sm">Send Raw Command</button>
                                    </div>
                                </section>

                                <!-- Developer Actions -->
                                <section>
                                    <h3 style="margin-bottom: 15px; color: #1a1a1a; font-size: 18px;">Developer Actions</h3>
                                    <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <button class="btn btn-secondary btn-sm">Export Logs</button>
                                            <button class="btn btn-secondary btn-sm">Clear Cache</button>
                                            <button class="btn btn-danger btn-sm" id="disableDevModeBtn">Disable Dev Mode</button>
                                        </div>
                                    </div>
                                </section>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Right Slide Panel - Communication Monitor -->
        <aside class="monitor-panel" id="monitorPanel">
            <div class="monitor-resize-handle" id="monitorResizeHandle"></div>
            <div class="monitor-panel-header">
                <h3>Communication Monitor</h3>
                <div class="monitor-panel-controls">
                    <div class="format-toggle">
                        <button class="format-btn active" data-format="hex">HEX</button>
                        <button class="format-btn" data-format="dec">DEC</button>
                    </div>
                    <button class="monitor-panel-close" id="monitorPanelClose" title="Close">√ó</button>
                </div>
            </div>
            <div class="monitor-panel-body">
                <div id="monitorDisplay" class="monitor-container">
                    <p class="placeholder">Waiting for communication...</p>
                </div>
                <!-- Scroll to bottom button -->
                <button class="monitor-scroll-btn" id="monitorScrollBtn" title="Scroll to bottom">
                    <span class="scroll-icon">‚Üì</span>
                    <span class="new-count" id="newMessageCount">0</span>
                </button>
            </div>
            <div class="monitor-panel-footer">
                <div class="monitor-footer-left">
                    <label class="auto-scroll-toggle">
                        <input type="checkbox" id="autoScrollToggle" checked>
                        <span>Auto Scroll</span>
                    </label>
                    <span class="monitor-entry-count" id="monitorEntryCount">0 packets</span>
                </div>
                <button id="clearBtn" class="btn btn-warning btn-sm">Clear Monitor</button>
            </div>
        </aside>
    </div>

    <!-- Add Parameter Modal -->
    <div id="addParamModal" class="modal">
        <div class="modal-content add-param-modal-content">
            <div class="modal-header">
                <h3>üìù ÏÉà ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÍ∞Ä</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body add-param-modal-body">
                <div class="add-param-form-group">
                    <div class="add-param-label">
                        <span class="add-param-icon">üè∑Ô∏è</span>
                        <label for="paramName">ÌååÎùºÎØ∏ÌÑ∞ Ïù¥Î¶Ñ</label>
                    </div>
                    <input type="text" id="paramName" placeholder="Ïòà: Temperature, Pressure, Speed...">
                    <small class="add-param-hint">Î™®ÎãàÌÑ∞ÎßÅÌï† ÌååÎùºÎØ∏ÌÑ∞Ïùò Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî</small>
                </div>
                <div class="add-param-form-group">
                    <div class="add-param-label">
                        <span class="add-param-icon">üìç</span>
                        <label for="paramAddress">Î†àÏßÄÏä§ÌÑ∞ Ï£ºÏÜå</label>
                    </div>
                    <input type="number" id="paramAddress" min="0" max="65535" value="0" placeholder="0 ~ 65535">
                    <small class="add-param-hint">Modbus Î†àÏßÄÏä§ÌÑ∞ Ï£ºÏÜå (0 ~ 65535)</small>
                </div>
                <div class="add-param-form-group">
                    <div class="add-param-label">
                        <span class="add-param-icon">‚öôÔ∏è</span>
                        <label for="paramFunction">Function Code</label>
                    </div>
                    <select id="paramFunction">
                        <option value="3">03 - Read Holding Registers (ÏùΩÍ∏∞/Ïì∞Í∏∞ Í∞ÄÎä•)</option>
                        <option value="4">04 - Read Input Registers (ÏùΩÍ∏∞ Ï†ÑÏö©)</option>
                        <option value="1">01 - Read Coils (ÎîîÏßÄÌÑ∏ Ï∂úÎ†•)</option>
                        <option value="2">02 - Read Discrete Inputs (ÎîîÏßÄÌÑ∏ ÏûÖÎ†•)</option>
                    </select>
                    <small class="add-param-hint">Îç∞Ïù¥ÌÑ∞Î•º ÏùΩÏñ¥Ïò¨ Modbus Ìï®Ïàò ÏΩîÎìúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</small>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelParamBtn" class="btn btn-secondary">Ï∑®ÏÜå</button>
                <button id="saveParamBtn" class="btn btn-primary">üíæ Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h3 id="confirmModalTitle">ÌôïÏù∏</h3>
                <button class="modal-close" id="confirmModalClose">&times;</button>
            </div>
            <div class="modal-body confirm-modal-body">
                <div class="confirm-icon" id="confirmModalIcon">‚ö†Ô∏è</div>
                <p id="confirmModalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="confirmCancelBtn" class="btn btn-secondary">‚úï Ï∑®ÏÜå</button>
                <button id="confirmOkBtn" class="btn btn-primary">‚úì ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- Device Edit Modal -->
    <div id="deviceEditModal" class="modal">
        <div class="modal-content device-edit-modal-content">
            <div class="modal-header">
                <h3 id="deviceEditModalTitle">Device Configuration</h3>
                <button class="modal-close" id="closeDeviceEditBtn">&times;</button>
            </div>
            <div class="modal-body device-edit-modal-body" id="deviceEditModalBody">
                <!-- Configuration content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content settings-modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button class="modal-close" id="closeSettingsBtn">&times;</button>
            </div>
            <div class="modal-body settings-modal-body">
                <!-- Settings Sidebar -->
                <div class="settings-sidebar">
                    <div class="settings-menu-item active" data-setting="statistics">
                        <span class="settings-menu-icon">üìä</span>
                        <span class="settings-menu-text">Statistics</span>
                    </div>
                    <div class="settings-menu-item" data-setting="autoscan">
                        <span class="settings-menu-icon">üîç</span>
                        <span class="settings-menu-text">Auto Scan</span>
                    </div>
                    <div class="settings-menu-item" data-setting="simulator">
                        <span class="settings-menu-icon">üîß</span>
                        <span class="settings-menu-text">Simulator</span>
                    </div>
                    <div class="settings-menu-item" data-setting="polling">
                        <span class="settings-menu-icon">üîÑ</span>
                        <span class="settings-menu-text">Polling</span>
                    </div>
                </div>

                <!-- Settings Content -->
                <div class="settings-content">
                    <!-- Statistics Settings -->
                    <div class="settings-panel active" id="settings-statistics">
                        <h4>Statistics Settings</h4>
                        <p style="color: #6c757d; margin-bottom: 20px; font-size: 13px;">
                            ÌÜµÍ≥Ñ Í≥ÑÏÇ∞ Î∞è ÌëúÏãú Î∞©Î≤ïÏùÑ ÏÑ§Ï†ïÌï©ÎãàÎã§.
                        </p>
                        <div class="form-group">
                            <label for="modal-baseFrameCount">Í∏∞Ï§Ä ÌîÑÎ†àÏûÑ Ïàò (Error Rate Í≥ÑÏÇ∞)</label>
                            <input type="number" id="modal-baseFrameCount" min="100" max="10000" value="1000" step="100">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                ÏóêÎü¨Ïú®ÏùÑ Í≥ÑÏÇ∞Ìï† Îïå ÏÇ¨Ïö©Ìï† Í∏∞Ï§Ä ÌîÑÎ†àÏûÑ ÏàòÏûÖÎãàÎã§. Ïòà: 1000 ÌîÑÎ†àÏûÑÎãπ Î™á Í∞úÏùò ÏóêÎü¨Í∞Ä Î∞úÏÉùÌïòÎäîÏßÄ Í≥ÑÏÇ∞Ìï©ÎãàÎã§.
                            </small>
                        </div>
                    </div>

                    <!-- Auto Scan Settings -->
                    <div class="settings-panel" id="settings-autoscan">
                        <h4>Auto Scan Settings</h4>
                        <p style="color: #6c757d; margin-bottom: 20px; font-size: 13px;">
                            ÏãúÎ¶¨Ïñº Ìè¨Ìä∏ Ïó∞Í≤∞ Ïãú ÏûêÎèôÏúºÎ°ú Ïû•ÏπòÎ•º ÌÉêÏÉâÌï©ÎãàÎã§.
                        </p>

                        <div class="form-group">
                            <label>ÏûêÎèô ÌÉêÏÉâ Î™®Îìú</label>
                            <div class="toggle-switch-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="autoScanEnabled">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="autoScanStatus" class="toggle-status">ÎπÑÌôúÏÑ±</span>
                            </div>
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                ÌôúÏÑ±ÌôîÌïòÎ©¥ Ïó∞Í≤∞ Ïãú ÏûêÎèôÏúºÎ°ú Slave IDÎ•º ÏàúÌöåÌïòÎ©∞ Ïû•ÏπòÎ•º ÌÉêÏÉâÌï©ÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group">
                            <label>ÌÉêÏÉâ Î≤îÏúÑ</label>
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <div style="flex: 1;">
                                    <label for="scanRangeStart" style="font-size: 12px; color: #6c757d;">ÏãúÏûë ID</label>
                                    <input type="number" id="scanRangeStart" min="1" max="247" value="1">
                                </div>
                                <span style="padding-top: 20px;">~</span>
                                <div style="flex: 1;">
                                    <label for="scanRangeEnd" style="font-size: 12px; color: #6c757d;">Ï¢ÖÎ£å ID</label>
                                    <input type="number" id="scanRangeEnd" min="1" max="247" value="10">
                                </div>
                            </div>
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                Î≤îÏúÑÍ∞Ä ÎÑìÏùÑÏàòÎ°ù ÌÉêÏÉâ ÏãúÍ∞ÑÏù¥ Ïò§Îûò Í±∏Î¶ΩÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="scanTimeout">ÏùëÎãµ ÎåÄÍ∏∞ ÏãúÍ∞Ñ (ms)</label>
                            <input type="number" id="scanTimeout" min="50" max="2000" value="200" step="50">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                Í∞Å Ïû•ÏπòÏùò ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî ÏµúÎåÄ ÏãúÍ∞ÑÏûÖÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="scanRegister">ÌÉêÏÉâÏö© Î†àÏßÄÏä§ÌÑ∞ Ï£ºÏÜå</label>
                            <input type="text" id="scanRegister" value="0xD011" placeholder="0xD011">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                Ïû•Ïπò Ï°¥Ïû¨ ÌôïÏù∏Ïóê ÏÇ¨Ïö©Ìï† Î†àÏßÄÏä§ÌÑ∞ Ï£ºÏÜå (Í∏∞Î≥∏: Motor Status)
                            </small>
                        </div>

                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button id="manualScanBtn" class="btn btn-primary">
                                <span>üîç</span> ÏàòÎèô ÌÉêÏÉâ ÏãúÏûë
                            </button>
                            <button id="stopScanBtn" class="btn btn-secondary" disabled>
                                <span>‚ñ†</span> ÌÉêÏÉâ Ï§ëÏßÄ
                            </button>
                        </div>

                        <div id="scanProgress" style="display: none; margin-top: 20px;">
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="scanProgressBar" style="width: 0%"></div>
                            </div>
                            <p id="scanProgressText" style="text-align: center; margin-top: 10px; color: #6c757d; font-size: 13px;"></p>
                        </div>

                        <div id="scanResults" style="display: none; margin-top: 20px; background: #f8f9fa; padding: 15px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 10px;">ÌÉêÏÉâ Í≤∞Í≥º:</strong>
                            <div id="scanResultsList" style="font-size: 13px;"></div>
                        </div>
                    </div>

                    <!-- Simulator Settings -->
                    <div class="settings-panel" id="settings-simulator">
                        <h4>Virtual Slave Simulator</h4>
                        <p style="color: #6c757d; margin-bottom: 20px; font-size: 13px;">
                            Ïã§Ï†ú Modbus Ïû•ÎπÑ ÏóÜÏù¥ ÌÖåÏä§Ìä∏Ìï† Ïàò ÏûàÎäî Í∞ÄÏÉÅ Ïä¨Î†àÏù¥Î∏å Ïû•ÏπòÏûÖÎãàÎã§.
                        </p>

                        <div class="form-group">
                            <label>ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÉÅÌÉú</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <button id="modal-simToggleBtn" class="btn btn-success">Activate</button>
                                <span id="modal-simStatus" style="color: #6c757d;">ÎπÑÌôúÏÑ±</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="modal-simSlaveId">Í∞ÄÏÉÅ Slave ID</label>
                            <input type="number" id="modal-simSlaveId" min="1" max="247" value="1">
                        </div>

                        <div class="form-group">
                            <label for="modal-simDelay">ÏùëÎãµ ÏßÄÏó∞ (ms)</label>
                            <input type="number" id="modal-simDelay" min="0" max="1000" value="50" step="10">
                        </div>

                        <button id="modal-simResetBtn" class="btn btn-warning">Î©îÎ™®Î¶¨ Ï¥àÍ∏∞Ìôî</button>

                        <div style="margin-top: 20px; background: #f8f9fa; padding: 15px; border-radius: 4px; font-family: 'Consolas', monospace; font-size: 12px;">
                            <div style="margin-bottom: 10px;">
                                <strong>Holding Registers:</strong><br>
                                [0] Ïò®ÎèÑ: <span id="modal-simTemp">--</span><br>
                                [1] ÏäµÎèÑ: <span id="modal-simHumid">--</span><br>
                                [2] ÏïïÎ†•: <span id="modal-simPress">--</span><br>
                                [3] Ï†ÑÏïï: <span id="modal-simVolt">--</span><br>
                                [5] ÏÜçÎèÑ: <span id="modal-simSpeed">--</span> RPM
                            </div>
                            <div>
                                <strong>Coils:</strong><br>
                                [0] ÏãúÏä§ÌÖú ÎèôÏûë: <span id="modal-simCoil0">--</span><br>
                                [1] ÏïåÎûå: <span id="modal-simCoil1">--</span><br>
                                [2] Ï§ÄÎπÑ: <span id="modal-simCoil2">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Polling Settings -->
                    <div class="settings-panel" id="settings-polling">
                        <h4>Polling Settings</h4>
                        <p style="color: #6c757d; margin-bottom: 20px; font-size: 13px;">
                            ÎîîÎ∞îÏù¥Ïä§ Î™®ÎãàÌÑ∞ÎßÅ Ìè¥ÎßÅ ÏÜçÎèÑÎ•º ÏÑ§Ï†ïÌï©ÎãàÎã§.
                        </p>

                        <div class="form-group">
                            <label for="pollingInterval">Polling Interval (ms)</label>
                            <input type="number" id="pollingInterval" min="10" max="5000" value="50" step="10">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                ÎîîÎ∞îÏù¥Ïä§ Í∞Ñ Ìè¥ÎßÅ Í∞ÑÍ≤©ÏûÖÎãàÎã§. Í∞íÏù¥ ÏûëÏùÑÏàòÎ°ù Îπ†Î•¥Í≤å ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏßÄÎßå ÌÜµÏã† Î∂ÄÌïòÍ∞Ä Ï¶ùÍ∞ÄÌï©ÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="pollingTimeout">Response Timeout (ms)</label>
                            <input type="number" id="pollingTimeout" min="50" max="5000" value="200" step="50">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                Í∞Å Î†àÏßÄÏä§ÌÑ∞ ÏùΩÍ∏∞ ÏöîÏ≤≠Ïùò ÏùëÎãµ ÎåÄÍ∏∞ ÏãúÍ∞ÑÏûÖÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="paramPollingDelay">Parameter Polling Delay (ms)</label>
                            <input type="number" id="paramPollingDelay" min="0" max="500" value="20" step="5">
                            <small style="color: #6c757d; margin-top: 5px; display: block;">
                                Î™®ÎãàÌÑ∞ÎßÅ ÌååÎùºÎØ∏ÌÑ∞ Í∞Ñ ÎîúÎ†àÏù¥ÏûÖÎãàÎã§. ÌÜµÏã† ÏïàÏ†ïÏÑ±ÏùÑ ÏúÑÌï¥ ÏïΩÍ∞ÑÏùò ÎîúÎ†àÏù¥Î•º Í∂åÏû•Ìï©ÎãàÎã§.
                            </small>
                        </div>

                        <div class="form-group" style="margin-top: 15px; padding: 15px; background: #1a1a2e; border: 1px solid #2d2d4e; border-radius: 8px;">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <label style="margin-bottom: 4px; display: block;">Background Polling</label>
                                    <small style="color: #6c757d; display: block;">
                                        Î∏åÎùºÏö∞Ï†Ä ÏµúÏÜåÌôî ÏãúÏóêÎèÑ Ìè¥ÎßÅ ÏÜçÎèÑÎ•º Ïú†ÏßÄÌï©ÎãàÎã§. Web Worker ÌÉÄÏù¥Î®∏Î•º ÏÇ¨Ïö©ÌïòÏó¨ Î∏åÎùºÏö∞Ï†Ä throttlingÏùÑ Ïö∞ÌöåÌï©ÎãàÎã§.
                                    </small>
                                </div>
                                <label class="toggle-switch" style="margin-left: 15px; flex-shrink: 0;">
                                    <input type="checkbox" id="backgroundPollingToggle">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: #e7f3ff; border-radius: 4px; font-size: 13px;">
                            <strong style="color: #007bff;">üí° Í∂åÏû• ÏÑ§Ï†ï</strong>
                            <ul style="margin: 10px 0 0 0; padding-left: 20px; color: #495057;">
                                <li><strong>Îπ†Î•∏ ÏùëÎãµ:</strong> Interval 50ms, Timeout 200ms</li>
                                <li><strong>ÏïàÏ†ïÏ†Å ÌÜµÏã†:</strong> Interval 200ms, Timeout 500ms</li>
                                <li><strong>Ï†ÄÎ∂ÄÌïò Î™®Îìú:</strong> Interval 500ms, Timeout 1000ms</li>
                            </ul>
                        </div>

                        <button id="applyPollingSettings" class="btn btn-primary" style="margin-top: 20px;">
                            Apply Settings
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Add Device Modal -->
    <div id="addDeviceModal" class="modal">
        <div class="modal-content add-device-modal-content">
            <div class="modal-header">
                <h3>‚ûï Add Device</h3>
                <button class="modal-close" id="closeDeviceModalBtn">&times;</button>
            </div>
            <div class="modal-body add-device-modal-body">
                <div class="add-device-form-group">
                    <div class="add-device-label">
                        <span class="add-device-icon">üè∑Ô∏è</span>
                        <label for="deviceName">Device Name</label>
                    </div>
                    <input type="text" id="deviceName" placeholder="e.g., Motor #1, Fan Unit A">
                </div>
                <div class="add-device-form-group">
                    <div class="add-device-label">
                        <span class="add-device-icon">üî¢</span>
                        <label for="deviceSlaveId">Slave ID</label>
                    </div>
                    <input type="number" id="deviceSlaveId" min="0" max="247" value="1">
                    <span class="add-device-hint">0 = ÎØ∏ÏÑ§Ï†ï (Auto AssignÏúºÎ°ú ÎÇòÏ§ëÏóê Ìï†Îãπ Í∞ÄÎä•)</span>
                </div>
                <div class="add-device-form-group">
                    <div class="add-device-label">
                        <span class="add-device-icon">‚öôÔ∏è</span>
                        <label for="deviceOperationMode">Default Operation Mode</label>
                    </div>
                    <select id="deviceOperationMode">
                        <option value="0">RPM Mode</option>
                        <option value="1">% Mode (Modulation)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelDeviceBtn" class="btn btn-secondary">Cancel</button>
                <button id="saveDeviceBtn" class="btn btn-primary">Add Device</button>
            </div>
        </div>
    </div>

    <!-- Auto Assign ID Modal -->
    <div id="autoAssignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Auto Assign Node IDs</h3>
                <button class="modal-close" id="closeAutoAssignModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: #fff3cd; padding: 15px; border-radius: 4px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                    <strong>ÏïàÎÇ¥:</strong>
                    <p style="margin: 10px 0 0 0; color: #856404;">
                        Ïù¥ Í∏∞Îä•ÏùÄ Slave IDÍ∞Ä 0ÏúºÎ°ú ÏÑ§Ï†ïÎêú Ï†úÌíàÎì§ÏóêÍ≤å ÏàúÏ∞®Ï†ÅÏúºÎ°ú IDÎ•º Ìï†ÎãπÌï©ÎãàÎã§.<br>
                        Ï†úÌíàÏùÄ Ìïú ÎåÄÏî© Ïó∞Í≤∞ÌïòÏó¨ IDÎ•º ÏÑ§Ï†ïÌïòÍ±∞ÎÇò, Broadcast(ID=0)Î•º ÏÇ¨Ïö©ÌïòÏó¨ Ìï†ÎãπÌï† Ïàò ÏûàÏäµÎãàÎã§.
                    </p>
                </div>
                <div class="form-group">
                    <label for="startingSlaveId">Starting Slave ID</label>
                    <input type="number" id="startingSlaveId" min="1" max="247" value="1">
                </div>
                <div class="form-group">
                    <label>Ìï†Îãπ Î∞©Î≤ï</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="assignMethod" value="sequential" checked>
                            <span>ÏàúÏ∞® Ìï†Îãπ (Ï†úÌíà ÏàúÏÑúÎåÄÎ°ú)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="assignMethod" value="broadcast">
                            <span>Broadcast Ìï†Îãπ (Ìïú ÎåÄÏî© Ïó∞Í≤∞ ÌïÑÏöî)</span>
                        </label>
                    </div>
                </div>
                <div id="autoAssignProgress" style="display: none;">
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="assignProgressBar" style="width: 0%"></div>
                    </div>
                    <p id="assignProgressText" style="text-align: center; margin-top: 10px; color: #6c757d;"></p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelAutoAssignBtn" class="btn btn-secondary">Cancel</button>
                <button id="startAutoAssignBtn" class="btn btn-primary">Start Assignment</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="modbus.js"></script>
    <script src="simulator.js"></script>
    <script src="os-test-manager.js"></script>
    <script src="app.js"></script>
</body>
</html>
